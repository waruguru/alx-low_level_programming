#!/bin/bash

# Check if README.md exists and is not empty
if [ ! -s README.md ]; then
    echo "README.md does not exist or is empty"
    exit 1
fi

# Check if the file 0-preprocessor has exactly 2 lines
if [ $(wc -l < 0-preprocessor) -ne 2 ]; then
    echo "File 0-preprocessor must be 2 lines long"
    exit 1
fi

# Check if the first line of 0-preprocessor contains "#!/bin/bash"
if [ "$(head -n 1 0-preprocessor)" != "#!/bin/bash" ]; then
    echo "First line of 0-preprocessor does not contain #!/bin/bash"
    exit 1
fi

# Get the C file name from the environment variable
CFILE=$CFILE

# Specify the output file name
OUTPUT_FILE="c"

# Run the C file through the preprocessor, remove comments, and save the result
cpp -P $CFILE | sed '/^$/d; /^#/d; s/\/\*.*\*\///g; s/\/\/.*//g' > $OUTPUT_FILE

# Display the last few lines of the output file for verification
tail $OUTPUT_FILE

